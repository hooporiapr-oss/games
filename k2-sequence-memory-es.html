<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Memoria de Secuencia - K-2 | Akashic</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Georgia,serif;background:linear-gradient(135deg,#1e3a5f,#2d5a87);min-height:100vh;color:#fff;display:flex;flex-direction:column;align-items:center;padding:15px}
.header{text-align:center;margin-bottom:15px}
.title{font-size:1.8em;margin-bottom:5px}
.grade{background:rgba(255,255,255,0.2);padding:5px 15px;border-radius:20px;font-size:0.85em;display:inline-block}
.box{background:rgba(255,255,255,0.1);border:2px solid rgba(255,255,255,0.3);border-radius:16px;padding:20px;width:100%;max-width:350px}
.info{display:flex;justify-content:space-around;margin-bottom:15px;text-align:center}
.info-item b{display:block;font-size:1.5em;color:#ffd700}
.info-item span{font-size:0.75em;opacity:0.8}
.grid-container{background:rgba(0,0,0,0.2);border-radius:12px;padding:15px;margin-bottom:15px}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;max-width:220px;margin:0 auto}
.cell{aspect-ratio:1;background:rgba(255,255,255,0.15);border:4px solid rgba(255,255,255,0.3);border-radius:16px;cursor:pointer;transition:all 0.2s}
.cell.lit{background:linear-gradient(135deg,#ffd700,#ff8c00);border-color:#ffd700;box-shadow:0 0 25px rgba(255,215,0,0.7);transform:scale(1.05)}
.cell.correct{background:linear-gradient(135deg,#2ecc71,#27ae60);border-color:#2ecc71}
.cell.wrong{background:linear-gradient(135deg,#e74c3c,#c0392b);border-color:#e74c3c}
.cell:active{transform:scale(0.95)}
.status{text-align:center;font-size:1.2em;margin-bottom:15px;min-height:35px;color:#ffd700}
.lives{display:flex;justify-content:center;gap:8px;margin-bottom:15px;font-size:1.5em}
.life.lost{opacity:0.3}
.btn{width:100%;padding:15px;font-size:1.1em;font-weight:bold;border:none;border-radius:25px;cursor:pointer;margin-top:10px}
.btn-start{background:linear-gradient(135deg,#2ecc71,#27ae60);color:#fff}
.btn-again{background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1e3a5f}
.btn:active{transform:scale(0.98)}
.result{text-align:center;padding:20px}
.result h2{color:#ffd700;font-size:1.5em;margin-bottom:10px}
.result .score{font-size:3em;color:#ffd700;font-weight:bold}
.result .label{opacity:0.8;margin-bottom:15px}
.stars{font-size:2em;margin:15px 0}
.hidden{display:none!important}
.home-link{position:absolute;top:15px;left:15px;color:#fff;text-decoration:none;font-size:0.9em;opacity:0.8}
.encouragement{background:rgba(255,215,0,0.2);padding:10px;border-radius:10px;text-align:center;margin-bottom:15px;font-size:0.95em}
</style>
</head>
<body>
<a href="digital-literacy-homepage.html" class="home-link">‚Üê Volver</a>

<div class="header">
<div class="title">üî≤ Memoria de Secuencia</div>
<div class="grade">üåü K-2 ‚Ä¢ Edades 5-8</div>
</div>

<div class="box">
<div id="startScreen">
<div class="encouragement">üß† ¬°Observa el patr√≥n y rep√≠telo!</div>
<div class="info">
<div class="info-item"><b>3</b><span>Vidas</span></div>
<div class="info-item"><b>2x2</b><span>Cuadr√≠cula</span></div>
</div>
<button class="btn btn-start" onclick="startGame()">‚ñ∂Ô∏è ¬°Jugar!</button>
</div>

<div id="gameScreen" class="hidden">
<div class="info">
<div class="info-item"><b id="levelNum">1</b><span>Nivel</span></div>
<div class="info-item"><b id="seqLen">1</b><span>Secuencia</span></div>
</div>
<div class="lives" id="livesDisplay">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
<div class="status" id="status">¬°Mira!</div>
<div class="grid-container">
<div class="grid" id="grid"></div>
</div>
</div>

<div id="resultScreen" class="hidden">
<div class="result">
<h2 id="resultTitle">¬°Muy Bien!</h2>
<div class="score" id="finalLevel">1</div>
<div class="label">Nivel Alcanzado</div>
<div class="stars" id="stars">‚≠ê‚≠ê‚≠ê</div>
<button class="btn btn-again" onclick="startGame()">üîÑ ¬°Jugar Otra Vez!</button>
</div>
</div>
</div>

<script>
var level = 1;
var lives = 3;
var sequence = [];
var playerSeq = [];
var canClick = false;
var gridSize = 4;

function $(id) { return document.getElementById(id); }

function show(id) {
    $('startScreen').classList.add('hidden');
    $('gameScreen').classList.add('hidden');
    $('resultScreen').classList.add('hidden');
    $(id).classList.remove('hidden');
}

function startGame() {
    level = 1;
    lives = 3;
    sequence = [];
    updateLives();
    show('gameScreen');
    buildGrid();
    nextLevel();
}

function buildGrid() {
    var grid = $('grid');
    grid.innerHTML = '';
    for (var i = 0; i < gridSize; i++) {
        var cell = document.createElement('div');
        cell.className = 'cell';
        cell.dataset.idx = i;
        cell.onclick = function() { clickCell(this); };
        grid.appendChild(cell);
    }
}

function nextLevel() {
    $('levelNum').textContent = level;
    $('seqLen').textContent = level;
    
    var newTile = Math.floor(Math.random() * gridSize);
    sequence.push(newTile);
    
    playerSeq = [];
    canClick = false;
    
    $('status').textContent = 'üëÄ ¬°Mira!';
    
    var cells = $('grid').children;
    for (var i = 0; i < cells.length; i++) {
        cells[i].className = 'cell';
    }
    
    setTimeout(playSequence, 800);
}

function playSequence() {
    var cells = $('grid').children;
    var i = 0;
    
    function showNext() {
        if (i > 0) {
            cells[sequence[i-1]].classList.remove('lit');
        }
        
        if (i < sequence.length) {
            cells[sequence[i]].classList.add('lit');
            i++;
            setTimeout(showNext, 800);
        } else {
            setTimeout(function() {
                if (i > 0) cells[sequence[i-1]].classList.remove('lit');
                $('status').textContent = 'üëÜ ¬°Tu turno!';
                canClick = true;
            }, 500);
        }
    }
    
    showNext();
}

function clickCell(cell) {
    if (!canClick) return;
    
    var idx = parseInt(cell.dataset.idx);
    playerSeq.push(idx);
    
    cell.classList.add('lit');
    setTimeout(function() { cell.classList.remove('lit'); }, 200);
    
    var pos = playerSeq.length - 1;
    if (playerSeq[pos] !== sequence[pos]) {
        canClick = false;
        cell.classList.add('wrong');
        lives--;
        updateLives();
        
        if (lives <= 0) {
            $('status').textContent = 'üò¢ ¬°Fin del juego!';
            setTimeout(showResult, 1500);
        } else {
            $('status').textContent = '‚ùå ¬°Ups! ¬°Mira de nuevo!';
            setTimeout(function() {
                cell.classList.remove('wrong');
                playSequence();
            }, 1500);
        }
    } else if (playerSeq.length === sequence.length) {
        canClick = false;
        cell.classList.add('correct');
        $('status').textContent = 'üéâ ¬°Muy bien!';
        level++;
        setTimeout(function() {
            cell.classList.remove('correct');
            nextLevel();
        }, 1000);
    }
}

function updateLives() {
    var html = '';
    for (var i = 0; i < 3; i++) {
        html += '<span class="life' + (i >= lives ? ' lost' : '') + '">‚ù§Ô∏è</span>';
    }
    $('livesDisplay').innerHTML = html;
}

function showResult() {
    show('resultScreen');
    $('finalLevel').textContent = level;
    
    var title, stars;
    if (level >= 8) { title = 'üèÜ ¬°Incre√≠ble!'; stars = '‚≠ê‚≠ê‚≠ê'; }
    else if (level >= 5) { title = 'üéâ ¬°Muy Bien!'; stars = '‚≠ê‚≠ê'; }
    else if (level >= 3) { title = 'üëç ¬°Buen Intento!'; stars = '‚≠ê'; }
    else { title = 'üí™ ¬°Sigue Practicando!'; stars = ''; }
    
    $('resultTitle').textContent = title;
    $('stars').textContent = stars;
}
</script>
</body>
</html>
